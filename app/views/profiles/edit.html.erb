<div class="max-w-lg mx-auto">
  <%= render "components/card" do %>
    <h1 class="text-2xl font-bold text-center text-gray-800 mb-8">
      <%= t("profile.edit_title") %>
    </h1>

    <%= render "shared/form_errors", object: current_user %>

    <%= form_with model: current_user, url: update_profile_path, method: :patch, class: "space-y-6" do |f| %>
      <!-- Avatar Upload -->
      <div class="text-center" data-controller="avatar-preview">
        <div class="mb-4 flex justify-center">
          <% if current_user.avatar.attached? %>
            <%= image_tag current_user.avatar.variant(resize_to_fill: [120, 120]),
                class: "w-28 h-28 rounded-full object-cover border-4 border-gray-200",
                data: { avatar_preview_target: "preview" } %>
          <% else %>
            <div class="w-28 h-28 rounded-full bg-gray-200 flex items-center justify-center border-4 border-gray-200"
                 data-avatar-preview-target="placeholder">
              <%= inline_svg_tag "svg/edit.svg", class: "w-6 h-6" %>
            </div>
          <% end %>
        </div>

        <%= f.label :avatar, class: "cursor-pointer inline-block" do %>
          <span class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm hover:bg-gray-200 transition-colors">
            <%= t("profile.change_avatar") %>
          </span>
          <%= f.file_field :avatar, accept: "image/*", class: "hidden",
              data: { avatar_preview_target: "input", action: "change->avatar-preview#preview" } %>
        <% end %>
        <p class="text-gray-500 text-xs mt-2"><%= t("profile.avatar_hint") %></p>
      </div>

      <%= render "forms/inputs/text_input", form: f, field: :first_name, label: t("profile.first_name") %>
      <%= render "forms/inputs/text_input", form: f, field: :last_name, label: t("profile.last_name") %>
      <%= render "forms/buttons/primary", form: f, label: t("profile.submit") %>
    <% end %>
  <% end %>
</div>
