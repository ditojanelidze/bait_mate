<%= render "shared/form_errors", object: post %>

<%= form_with model: post, class: "space-y-6" do |f| %>
  <!-- Image Upload -->
  <div data-controller="image-preview">
    <%= f.label :image, t("posts.image"), class: "block text-sm font-medium text-gray-700 mb-1" %>
    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-500 transition-colors">
      <% if post.image.attached? %>
        <%= image_tag post.image.variant(resize_to_limit: [400, 400]),
            class: "max-h-48 mx-auto rounded-lg mb-4",
            data: { image_preview_target: "preview" } %>
      <% else %>
        <div data-image-preview-target="placeholder" class="mb-4">
          <%= inline_svg_tag "svg/image.svg", class: "w-12 h-12 text-gray-400 mx-auto" %>
        </div>
      <% end %>

      <%= f.label :image, class: "cursor-pointer inline-block" do %>
        <span class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-blue-700 transition-colors inline-block">
          <%= post.image.attached? ? t("posts.change_image") : t("posts.image") %>
        </span>
        <%= f.file_field :image, accept: "image/*", class: "hidden",
            data: { image_preview_target: "input", action: "change->image-preview#preview" } %>
      <% end %>
      <p class="text-gray-500 text-xs mt-2"><%= t("posts.image_hint") %></p>
    </div>
  </div>

  <%= render "forms/inputs/textarea", form: f, field: :description, label: t("posts.description"), placeholder: t("posts.description_placeholder") %>
  <%= render "forms/inputs/text_input", form: f, field: :specie, label: t("posts.specie"), placeholder: t("posts.specie_placeholder") %>
  <%= render "forms/inputs/text_input", form: f, field: :location, label: t("posts.location"), placeholder: t("posts.location_placeholder") %>
  <%= render "forms/inputs/text_input", form: f, field: :rod, label: t("posts.rod"), placeholder: t("posts.rod_placeholder") %>
  <%= render "forms/inputs/text_input", form: f, field: :bait, label: t("posts.bait"), placeholder: t("posts.bait_placeholder") %>
  <%= render "forms/buttons/primary", form: f, label: post.persisted? ? t("posts.update") : t("posts.submit") %>
<% end %>
